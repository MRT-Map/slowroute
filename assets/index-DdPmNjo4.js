(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))d(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function d(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}})();class k{data;constructor(e){this.data=e}static async get(){return new k(await fetch("https://raw.githubusercontent.com/MRT-Map/gatelogue/dist/data.json").then(e=>e.json()))}static async getNoSources(){return new k(await fetch("https://raw.githubusercontent.com/MRT-Map/gatelogue/dist/data_no_sources.json").then(e=>e.json()))}node(e){return this.data.nodes[typeof e=="string"?e:e.toString()]}get nodes(){return Object.values(this.data.nodes)}airFlight(e){return this.node(e)}get airFlights(){return this.nodes.filter(e=>e.type==="AirFlight")}airAirport(e){return this.node(e)}get airAirports(){return this.nodes.filter(e=>e.type==="AirAirport")}airGate(e){return this.node(e)}get airGates(){return this.nodes.filter(e=>e.type==="AirGate")}airAirline(e){return this.node(e)}get airAirlines(){return this.nodes.filter(e=>e.type==="AirAirline")}railCompany(e){return this.node(e)}get railCompanies(){return this.nodes.filter(e=>e.type==="RailCompany")}railLine(e){return this.node(e)}get railLines(){return this.nodes.filter(e=>e.type==="RailLine")}railStation(e){return this.node(e)}get railStations(){return this.nodes.filter(e=>e.type==="RailStation")}seaCompany(e){return this.node(e)}get seaCompanies(){return this.nodes.filter(e=>e.type==="SeaCompany")}seaLine(e){return this.node(e)}get seaLines(){return this.nodes.filter(e=>e.type==="SeaLine")}seaStop(e){return this.node(e)}get seaStops(){return this.nodes.filter(e=>e.type==="SeaStop")}busCompany(e){return this.node(e)}get busCompanies(){return this.nodes.filter(e=>e.type==="BusCompany")}busLine(e){return this.node(e)}get busLines(){return this.nodes.filter(e=>e.type==="BusLine")}busStop(e){return this.node(e)}get busStops(){return this.nodes.filter(e=>e.type==="BusStop")}spawnWarp(e){return this.node(e)}get spawnWarps(){return this.nodes.filter(e=>e.type==="SpawnWarp")}town(e){return this.node(e)}get towns(){return this.nodes.filter(e=>e.type==="Town")}}const j=document.getElementById("from"),G=document.getElementById("to"),T=document.getElementById("out"),I=document.getElementById("go"),i=await k.getNoSources();function g(t){const e=t.codes??(t.code?[t.code]:[]),a=t.names?t.names.join("/"):t.name;return e.length!==0&&a&&(e.length!=1||e[0]!==a)?`${a} (${e.join("/")})`:a?a??"":e?.join("/")??""}let _=[];for(const t of i.nodes){let e;switch(t.type){case"AirAirport":const a=t;e=`${a.names?.join("/")} (${a.code})`;break;case"BusStop":const d=t;e=`[${i.busCompany(d.company).name}] `+g(d);break;case"RailStation":const o=t;e=`[${i.busCompany(o.company).name}] `+g(o);break;case"SeaStop":const h=t;e=`[${i.busCompany(h.company).name}] `+g(h);break;case"Town":const y=t;e=`${y.name} (${y.rank})`;break;case"SpawnWarp":e=t.name;break;default:continue}_.push([t.i,`${t.type} ${e}`])}const x=_.sort(([t,e],[a,d])=>e.localeCompare(d)).map(([t,e])=>`<option value="${t}">${e}</option>`).join();j.innerHTML=x;G.innerHTML=x;const N=10,O=8,C=15;function B(t,e){const a=[`${t}`],d=new Map;d.set(`${t}`,0);const s=new Map;for(const l of i.spawnWarps)s.set(`${l.i}`,{from:`${t}`,text:`Take spawn warp to ${l.name}`}),d.set(`${l.i}`,C),a.push(`${l.i}`);const o=new Map;for(;a.length!==0;){console.log(a.length);const l=a.sort((f,r)=>d.get(r)-d.get(f)).pop(),h=parseInt(l.split(" ")[0]),A=l.includes(" ")?parseInt(l.split(" ")[1]):void 0,y=d.get(l);if(h===e){const f=[];let r=l;for(;r.split(" ")[0]!==`${t}`;){let{from:$,text:w}=s.get(r);r=$,w&&f.push(w)}return f.reverse()}let b=i.node(h);if(console.log(b),b.type!=="AirGate"){const f=b;for(const[r,$]of Object.entries(f.proximity)){const w=i.node(r);o.set(r,{cost:y+$.distance/O+C,text:`Fly ${Math.round($.distance)} blocks to ${w.type} ${g(w)}`})}for(const r of f.shared_facility){const $=i.node(r);o.set(`${r}`,{cost:y+C,text:`Change to ${$.type} ${i.node($.company).name} ${g(i.node(r))}`})}}switch(b.type){case"AirAirport":const f=b;for(const c of f.gates){const m=i.airGate(c).code;o.set(`${c}`,{cost:y+C,text:m?`Go to gate ${m}`:void 0})}break;case"AirGate":const r=b;o.set(`${r.airport}`,{cost:y});for(const c of i.airAirport(r.airport).gates){if(c===h)continue;const m=i.airGate(c).code;o.set(`${c}`,{cost:y+C,text:m?`Go to gate ${m}`:void 0})}for(const c of r.flights){const m=i.airFlight(c);for(const S of m.gates){if(S===h)continue;const n=i.airGate(S),p=i.airAirline(m.airline).name,L=m.codes.join("/"),u=i.airAirport(n.airport);o.set(`${S}`,{cost:y+N,text:(r.code!==null?`At Gate ${r.code} t`:"T")+`ake ${p} ${L} to ${g(u)}`+(n.code!==null?` (Gate ${n.code})`:"")})}}break;case"BusStop":const $=b;for(const[c,m]of Object.entries($.connections)){const S=i.busStop(c);for(const n of m){if(n.direction&&n.direction.one_way&&n.direction.direction===h)continue;const p=i.busLine(n.line),L=i.busCompany(p.company).name;let u=(n.direction?.direction===h?n.direction?.backward_label:n.direction?.forward_label)??"";u&&(u=`(${u}) `),o.set(`${c} ${p.i}`,{cost:y+N+(A===p.i?0:C),text:`Take ${L} ${g(p)} ${u}to ${g(S)}`})}}break;case"RailStation":const w=b;for(const[c,m]of Object.entries(w.connections)){const S=i.railStation(c);for(const n of m){if(n.direction&&n.direction.one_way&&n.direction.direction===h)continue;const p=i.railLine(n.line),L=i.railCompany(p.company).name;let u=(n.direction?.direction===h?n.direction?.backward_label:n.direction?.forward_label)??"";u&&(u=`(${u}) `),o.set(`${c} ${p.i}`,{cost:y+N+(A===p.i?0:C),text:`Take ${L} ${g(p)} ${u}to ${g(S)}`})}}break;case"SeaStop":const M=b;for(const[c,m]of Object.entries(M.connections)){const S=i.railStation(c);for(const n of m){if(n.direction&&n.direction.one_way&&n.direction.direction===h)continue;const p=i.seaLine(n.line),L=i.seaCompany(p.company).name;let u=(n.direction?.direction===h?n.direction?.backward_label:n.direction?.forward_label)??"";u&&(u=`(${u}) `),o.set(`${c} ${p.i}`,{cost:y+N+(A===p.i?0:C),text:`Take ${L} ${g(p)} ${u}to ${g(S)}`})}}break;case"SpawnWarp":break;default:continue}for(const[f,{cost:r,text:$}]of o){const w=d.get(f)??1/0;d.has(f)||a.push(f),r<w&&(s.set(f,{from:l,text:$}),d.set(f,r))}o.clear()}return["No solution"]}I.addEventListener("click",()=>{T.innerHTML="";const t=parseInt(j.value),e=parseInt(G.value);if(t===e){T.innerHTML="Already there";return}T.innerHTML+=B(t,e).join("<br>")});
